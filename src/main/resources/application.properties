# ============================================
# APPLICATION.PROPERTIES - API GATEWAY (CORREGIDO)
# ============================================

spring.application.name=gateway

# ============================================
# SERVER CONFIGURATION
# ============================================
server.port=8080

# ============================================
# JWT CONFIGURATION (DEBE SER IGUAL QUE AUTH SERVICE)
# ============================================
jwt.secret=XWgEf7xRA6tkom6nODTX0W4GYYq6CnGOyzo+8QtJDnM=

# ============================================
# CORS CONFIGURATION (Nueva sintaxis sin deprecaci√≥n)
# ============================================
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-origins[0]=http://localhost:5173
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-origins[1]=http://localhost:3000
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-origins[2]=http://localhost:4200
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[0]=GET
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[1]=POST
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[2]=PUT
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[3]=PATCH
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[4]=DELETE
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods[5]=OPTIONS
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-headers=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allow-credentials=true
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].max-age=3600

# ============================================
# ROUTE 0: AUTH SERVICE - PUBLIC (sin AuthenticationFilter)
# ============================================
spring.cloud.gateway.routes[0].id=auth-public
spring.cloud.gateway.routes[0].uri=http://localhost:8081
spring.cloud.gateway.routes[0].predicates[0]=Path=/auth/login,/auth/register,/auth/refresh,/auth/forgot-password,/auth/reset-password

# ============================================
# ROUTE 1: AUTH SERVICE - PROTECTED (con AuthenticationFilter)
# ============================================
spring.cloud.gateway.routes[1].id=auth-protected
spring.cloud.gateway.routes[1].uri=http://localhost:8081
spring.cloud.gateway.routes[1].predicates[0]=Path=/auth/me,/auth/logout,/auth/logout-all,/auth/change-password,/auth/profile
spring.cloud.gateway.routes[1].filters[0]=AuthenticationFilter

# ============================================
# ROUTE 2: PRODUCTS SERVICE
# ============================================
spring.cloud.gateway.routes[2].id=products-service
spring.cloud.gateway.routes[2].uri=http://localhost:8082
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/productos/**
spring.cloud.gateway.routes[2].filters[0]=AuthenticationFilter

# ============================================
# ROUTE 3: ORDERS SERVICE
# ============================================
spring.cloud.gateway.routes[3].id=orders-service
spring.cloud.gateway.routes[3].uri=http://localhost:8083
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/ordenes/**
spring.cloud.gateway.routes[3].filters[0]=AuthenticationFilter

# ============================================
# ROUTE 4: PAYMENTS SERVICE
# ============================================
spring.cloud.gateway.routes[4].id=payments-service
spring.cloud.gateway.routes[4].uri=http://localhost:8084
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/pagos/**
spring.cloud.gateway.routes[4].filters[0]=AuthenticationFilter

# ============================================
# ROUTE 5: ADMIN SERVICE
# ============================================
spring.cloud.gateway.routes[5].id=admin-service
spring.cloud.gateway.routes[5].uri=http://localhost:8085
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/v1/admin/**
spring.cloud.gateway.routes[5].filters[0]=AuthenticationFilter
spring.cloud.gateway.routes[5].filters[1]=AdminAuthorizationFilter

# ============================================
# LOGGING
# ============================================
logging.level.root=INFO
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.com.example.gateway=DEBUG

# ============================================
# ACTUATOR
# ============================================
management.endpoints.web.exposure.include=health,info,gateway
management.endpoint.health.show-details=always

# ============================================
# REDIS (Comentado - Solo si tienes Redis instalado)
# ============================================
# spring.data.redis.host=localhost
# spring.data.redis.port=6379